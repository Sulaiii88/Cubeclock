<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CubeClock</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Schriftart Space Mono von Google Fonts einbinden -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono&display=swap" rel="stylesheet" />
  
  <!-- Manifest für PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#000000" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <!-- Service Worker zum Offline-Betrieb registrieren -->
  <script>
    if ('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js');
  </script>

  <style>
    /* ===============================
       Basis-Layout: Würfel-Uhr
       =============================== */

    /* Grund-Styles für die Seite */
    body {
      margin: 0;
      background: #000; /* schwarzer Hintergrund */
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: 'Space Mono', monospace; /* Monospace-Schrift */
      overflow: hidden;
      touch-action: none; /* kein Scrollen bei Touch */
    }

    /* Bereich für die 3D-Szene (Würfel) */
    .scene {
      width: 63vmin;
      height: 63vmin;
      perspective: 1100px; /* Tiefe für 3D-Effekt */
      margin-bottom: 90px;
    }

    /* Der Würfel an sich */
    .cube {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 1s ease; /* sanfte Drehung */
      transform: rotateX(-30deg) rotateY(45deg); /* Start-Position */
    }

    /* Jede Seite des Würfels */
    .face {
      position: absolute;
      width: 100%;
      height: 100%;
      background: linear-gradient(to bottom right, #000, #111); /* leichter Verlauf */
      color: #fff;
      font-size: calc(63vmin / 1.5);
      letter-spacing: -5px;
      display: flex;
      justify-content: center;
      align-items: center;
      border: 1px solid #555;
      backface-visibility: hidden; /* Rückseite nicht anzeigen */
    }

    /* IDs für jede Zeit-Komponente mit Standardfarben */
    #hours { color: #e71f1b; }
    #minutes { color: #ff8c42; }
    #seconds { color: #fff275; }
    #year { color: #4B0082; }
    #month { color: #2f4fba; font-size: calc(63vmin / 2); font-weight: bold; }
    #day { color: #87c8fa; }

    /* Position jeder Würfelseite im 3D-Raum */
    .front { transform: rotateY(90deg) translateZ(31.5vmin) rotateY(180deg) rotateX(180deg); }
    .back  { transform: rotateY(180deg) translateZ(31.5vmin) rotateY(180deg) rotateX(180deg); }
    .right { transform: rotateY(0deg) translateZ(31.5vmin); }
    .left  { transform: rotateY(-90deg) translateZ(31.5vmin); }
    .top   { transform: rotateX(90deg) translateZ(31.5vmin); }
    .bottom{ transform: rotateX(-90deg) translateZ(31.5vmin); }

    /* Button unten für Zeit/Datum-Umschaltung */
    #toggleButton {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 5vh;
      padding: 1px 100px;
      border: none;
      outline: none;
      box-shadow: none;
      border-radius: 10px;
      background: #444;
      cursor: pointer;
      z-index: 10;
    }
    #toggleButton:hover { background: #666; }
    #toggleButton img { width: 30px; height: auto; display: block; }

    /* ===== Responsive Anpassung für größere Bildschirme ===== */
    @media (min-width: 601px) {
      .scene { width: 50vmin; height: 50vmin; }
      .face { font-size: calc(50vmin / 1.5); }
      #month { font-size: calc(50vmin / 2); }
      .front { transform: rotateY(90deg) translateZ(25vmin) rotateY(180deg) rotateX(180deg); }
      .back  { transform: rotateY(180deg) translateZ(25vmin) rotateY(180deg) rotateX(180deg); }
      .right { transform: rotateY(0deg) translateZ(25vmin); }
      .left  { transform: rotateY(-90deg) translateZ(25vmin); }
      .top   { transform: rotateX(90deg) translateZ(25vmin); }
      .bottom{ transform: rotateX(-90deg) translateZ(25vmin); }
    }

    /* Wenn App als PWA im Standalone-Mode läuft */
    @media (display-mode: standalone) and (max-width: 600px) {
      .scene { transform: scale(3); transform-origin: center; }
    }

    /* ===============================
       Settings-Panel & Zahnrad-Button
       =============================== */

    /* Hintergrund für Einstellungen */
    #settingsOverlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.45);
      display: none;
      z-index: 150;
    }

    /* Zahnrad-Button oben links */
    #settingsButton {
      position: fixed;
      top: calc(env(safe-area-inset-top,0px) + 12px);
      left: calc(env(safe-area-inset-left,0px) + 12px);
      width: 44px;
      height: 44px;
      padding: 8px;
      background: #222;
      border: 1.5px solid rgba(255,255,255,.35); /* leichter Rahmen */
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(0,0,0,.35);
      cursor: pointer;
      z-index: 200;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #settingsButton img {
      width: 28px;
      height: 28px;
      display: block;
      filter: drop-shadow(0 0 2px rgba(0,0,0,.3));
    }

    /* Panel für die Einstellungen */
    #settingsPanel {
      position: fixed;
      top: calc(env(safe-area-inset-top,0px) + 62px);
      left: calc(env(safe-area-inset-left,0px) + 12px);
      display: none;
      z-index: 180;
      width: clamp(240px,86vw,340px);
      max-height: calc(100dvh - 96px); /* passt sich Höhe an */
      overflow: auto;
      overscroll-behavior: contain;
      background: #222;
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 18px;
      color: #fff;
      box-shadow: 0 18px 40px rgba(0,0,0,.5);
      padding: 14px 12px 18px;
    }

    /* Pfeil vom Panel */
    #panelArrow {
      position: fixed;
      display: none;
      z-index: 181;
      top: calc(env(safe-area-inset-top,0px) + 54px);
      left: calc(env(safe-area-inset-left,0px) + 36px);
      width: 0;
      height: 0;
      border-left: 10px solid transparent;
      border-right: 10px solid transparent;
      border-bottom: 12px solid #222;
    }

    /* Titel im Panel */
    #settingsPanel h3 {
      margin: 0 0 10px;
      font-size: 20px;
      letter-spacing: .5px;
    }

    /* Jede Reihe im Panel */
    .row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      font-size: 18px;
      color: #eaeaea;
      margin: 8px 0;
    }

    /* Farbfelder (Chips) */
    .chip {
      width: 50px;
      height: 28px;
      border: 4px solid #fff;
      border-radius: 8px;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.35),0 2px 8px rgba(0,0,0,.25);
      cursor: pointer;
      position: relative;
      background: #000;
    }
    .chip::after {
      content: "";
      position: absolute;
      inset: 4px;
      border-radius: 6px;
      background: var(--chip,#000);
    }

    /* Buttons im Panel */
    .btn {
      display: block;
      width: 100%;
      margin-top: 10px;
      padding: 9px 10px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.1);
      background: #2b2b2b;
      color: #e8e8e8;
      font-size: 14px;
      text-align: center;
      box-shadow: inset 0 -2px 0 rgba(255,255,255,.05), 0 2px 10px rgba(0,0,0,.25);
    }
    .btn:hover { background: #3a3a3a; }

    /* usw... */
  </style>
</head>
<body>
  <!-- Würfel-Uhr -->
  <div class="scene">
    <div class="cube" id="cube">
      <div class="face front"  id="year">00</div>
      <div class="face back"   id="month">00</div>
      <div class="face right"  id="seconds">00</div>
      <div class="face left"   id="minutes">00</div>
      <div class="face top"    id="hours">00</div>
      <div class="face bottom" id="day">00</div>
    </div>
  </div>

  <!-- Button zum Wechseln der Ansicht -->
  <button id="toggleButton" onclick="toggleCube()">
    <img src="spacebar_icon.png" alt="spacebar" />
  </button>

  <!-- Zahnrad-Button für Einstellungen -->
  <button id="settingsButton" type="button" aria-label="Settings">
    <img src="settings.png" alt="Settings" />
  </button>
  <div id="panelArrow"></div>
  <div id="settingsOverlay"></div>

  <!-- Panel mit allen Einstellmöglichkeiten -->
  <div id="settingsPanel" role="dialog" aria-label="Settings">
    <h3>Change colors</h3>
    <div class="row">Hour:       <div class="chip" id="chipHours"   data-key="hours"></div></div>
    <div class="row">Minute:     <div class="chip" id="chipMinutes" data-key="minutes"></div></div>
    <div class="row">Second:     <div class="chip" id="chipSeconds" data-key="seconds"></div></div>
    <div class="row">Year:       <div class="chip" id="chipYear"    data-key="year"></div></div>
    <div class="row">Month:      <div class="chip" id="chipMonth"   data-key="month"></div></div>
    <div class="row">Day:        <div class="chip" id="chipDay"     data-key="day"></div></div>
    <div class="row">Cube:       <div class="chip" id="chipCube"    data-key="cube"></div></div>
    <div class="row">Background: <div class="chip" id="chipBackground" data-key="background"></div></div>

    <!-- Bereich für Auto-Reset -->
    <div class="reset-block">
      <strong>Auto reset</strong>
      <div class="reset-row">
        <input type="checkbox" id="autoResetEnable">
        <label for="autoResetEnable">Enable</label>
      </div>
      <div class="reset-row">
        <label for="autoResetSeconds">Seconds</label>
        <input type="number" id="autoResetSeconds" min="1" max="3600" step="1" placeholder="10">
      </div>
    </div>

    <!-- Buttons unten -->
    <button class="btn" type="button" id="btnDefaults">Reset to defaults</button>
    <button class="btn" type="button" onclick="toggleCube()">Time/Date (space)</button>
    <button class="btn" type="button" id="closeSettingsBtn">Close</button>
  </div>

  <!-- RGB-Picker Popup -->
  <div id="pickerOverlay"></div>
  <div id="picker">
    <h4>Select color</h4>
    <!-- Farbauswahl -->
    <div class="sv-wrap">
      <canvas id="sv"></canvas>
      <div class="sv-cursor" id="svc"></div>
    </div>
    <!-- Hue-Slider -->
    <div class="h-wrap">
      <input id="h" type="range" min="0" max="360" value="0">
    </div>
    <!-- Vorschau -->
    <div id="preview"></div>
    <!-- RGB-Eingabefelder -->
    <div class="rgb-row">
      <div class="cell"><label for="r">R</label><input id="r" type="number" min="0" max="255"></div>
      <div class="cell"><label for="g">G</label><input id="g" type="number" min="0" max="255"></div>
      <div class="cell"><label for="b">B</label><input id="b" type="number" min="0" max="255"></div>
    </div>
    <!-- Buttons im Picker -->
    <div class="picker-actions">
      <button id="cancelPick">Cancel</button>
      <button id="applyPick" class="primary">Apply</button>
    </div>
  </div>

  <script>
    // ... HIER kommt dann der JavaScript-Code mit Erklärungen ...
  </script>
</body>
</html>
